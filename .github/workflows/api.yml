name: api

on:
  workflow_dispatch:

jobs:
  env_setup:
    runs-on: ubuntu-latest
    steps:
      - name: api
        uses: indiesdev/curl@v1.1
        id: api
        with:
          url: https://api.github.com/repos/bromba-noesis/envs-public/environments/QA
          method: "PUT"
          accept: 200, 422
          headers: '{ "Accept": "application/vnd.github+json", "X-GitHub-Api-Version": "2022-11-28" }'
          bearer-token: ${{ secrets.BROMBA_NOESIS_PAT2 }}
          body: '{ "reviewers":[{"type":"User","id":126766083}], "deployment_branch_policy":{"protected_branches":false,"custom_branch_policies":true} }'    # find user id here: https://caius.github.io/github_id/
          
      - name: response
        run: |
          set +x
          echo ${{ steps.api.outputs.response }} 
      
      - name: parsed_response
        run: |
          set +x
          echo '${{ fromJson(steps.api.outputs.response).status_code }}'
